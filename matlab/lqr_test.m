% LQR system
close all;
clear all;
clc;

A = zeros(4);
A(1,1) = 0.9959087183717342;
A(1,2) = -6.030826161300013e-5;
A(2,1) = 0.41865605911982634;
A(2,2) = 1.0100636509899334;
A(1,3) = 1;
A(2,4) = 1;
A(3,3) = 1;
A(4,4) = 1;

B = zeros(4,1);
B(1,1) = -2.5208572677265433e-9;
B(2,1) = 8.410255357348953e-5;

b = zeros(2,1);
b(1,1) = 0.026856922933866625;
b(2,1) = -4.352403907113325;

C = [1.0, 0.0, 0.0, 0.0];
D = 0.0;

% ssmat = [eye(4)-A -B;C 0];
% ssvec = zeros(5,1);
% ssvec(5) = 0.48; 

% xs = [0.48934869384882873; 412.1302612302342];
% x0 = [0.5; 400];
% 
sys = ss(A,B,C,D, 0.1);
% 
Q = zeros(4);
Q(1,1) = 1.0;
R = zeros(1);
R(1,1) = 1.0;
% 
K = dlqr(A,B,Q,R);
